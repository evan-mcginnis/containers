#!/usr/bin/env python
from kafka import KafkaProducer
import json
import threading
import time

class myThread(threading.Thread):
	def __init__(self, threadID, name, counter):
		threading.Thread.__init__(self)
		self.threadID=threadID
		self.name = name
		self.counter = counter
	def run(self):
		generate(self.name, self.counter)

def generate(threadName, counter):

	generater = KafkaProducer(bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8'))

	for _ in range(counter):
		generater.send('syslog', {'name' : threadName, 'alarm': 'packet-drop'})

print("%s" % (time.ctime(time.time())))
for x in range(1000):
	try:	
		thread = myThread(x, "thread"+str(x), 100)
		thread.start()
	except Exception as inst:
		print inst 
print("%s" % (time.ctime(time.time())))

